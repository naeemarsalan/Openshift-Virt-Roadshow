= Deployment Strategies

OpenShift supports a variety of workload types and deployment techniques to suit different application needs. This section introduces the most common workload types and explains how to implement and tune health checks for reliable operation.

== Workload Types

OpenShift supports several Kubernetes workload types, each suited to different deployment scenarios:

=== Deployment

* The most common workload type.
* Supports rolling updates, rollbacks, and scaling.
* Ideal for **stateless web apps, APIs**, and microservices.

[source,sh]
----
oc create deployment my-app --image=nginx
----

=== StatefulSet

* Designed for **stateful applications** that need stable network identity and persistent storage (e.g., databases).
* Pods are created in a strict order and maintain their names.

[source,yaml]
----
kind: StatefulSet
metadata:
  name: my-db
----

=== DaemonSet

* Ensures a pod runs on **every node** (or a subset).
* Ideal for **log collectors, monitoring agents**, or infrastructure tools.

[source,yaml]
----
kind: DaemonSet
metadata:
  name: node-exporter
----

=== Job / CronJob

* Run once (`Job`) or on a schedule (`CronJob`).
* Ideal for **batch tasks**, **backups**, or **data processing**.

[source,sh]
----
oc create job --image=busybox run-once -- echo "hello world"
----

== Health Checks

OpenShift uses **probes** to monitor application health and availability. These allow the platform to take automated action when a container becomes unhealthy.

=== Liveness Probe

* Checks if the app is **still running**.
* If it fails, the container is restarted.

[source,yaml]
----
livenessProbe:
  httpGet:
    path: /health
    port: 8080
  initialDelaySeconds: 10
  periodSeconds: 5
----

=== Readiness Probe

* Checks if the app is **ready to serve traffic**.
* If it fails, the pod is removed from the service endpoint list.

[source,yaml]
----
readinessProbe:
  httpGet:
    path: /ready
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 3
----

=== Startup Probe

* Used for **slow-starting applications**.
* Overrides liveness probe until it succeeds.

[source,yaml]
----
startupProbe:
  httpGet:
    path: /startup
    port: 8080
  failureThreshold: 30
  periodSeconds: 10
----

=== Exercise: Configure Probes

. Deploy a sample app (or reuse an existing one).
. Add `livenessProbe`, `readinessProbe`, and `startupProbe` fields to its deployment spec.
. Use `oc describe pod` to see probe status.
. Simulate failure by modifying the app to return errors and observe pod behavior.
